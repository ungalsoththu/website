---
phase: 01-foundation
plan: 02
type: execute
---

<objective>
Configure GitHub Actions workflow for automatic deployment to GitHub Pages.

Purpose: Enable continuous deployment - every push to main automatically builds and deploys the site.
Output: Working GitHub Actions workflow that builds Astro site and deploys to GitHub Pages.
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-phase.md
~/.claude/get-shit-done/references/checkpoints.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/01-foundation/01-RESEARCH.md
@.planning/phases/01-foundation/01-01-PLAN.md

**Code examples from RESEARCH.md:**
```yaml
# .github/workflows/deploy.yml
name: Deploy to GitHub Pages
on:
  push:
    branches: [ main ]
permissions:
  contents: read
  pages: write
  id-token: write
jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v5
      - uses: withastro/action@v5
      - uses: actions/deploy-pages@v4
```

**Don't hand-roll (from RESEARCH.md):**
- Don't write custom build/deploy scripts - use official withastro/action@v5

**Common pitfalls (from RESEARCH.md):**
- Missing permissions (pages: write, id-token: write) causes deployment failures
- Build cache issues - add cache headers in workflow

**GitHub Pages requirement:**
- Source must be set to "GitHub Actions" in repo Settings > Pages
</context>

<tasks>

<task type="auto">
  <name>Task 1: Create GitHub Actions deployment workflow</name>
  <files>.github/workflows/deploy.yml</files>
  <action>Create .github/workflows directory and deploy.yml file with:

```yaml
name: Deploy to GitHub Pages

on:
  push:
    branches: [ main ]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v5

      - name: Build with Astro
        uses: withastro/action@v5

      - name: Deploy to GitHub Pages
        id: deployment
        uses: actions/deploy-pages@v4
```

Key points:
- permissions: pages and id-token are REQUIRED for GitHub Pages deployment
- concurrency group prevents overlapping deployments
- withastro/action@v5 handles build automatically (no manual npm run build needed)

DO NOT use older actions (v4 or below) - v5 has latest Astro support.
  </action>
  <verify>.github/workflows/deploy.yml exists with correct structure</verify>
  <done>Workflow file created with all required permissions and job steps</done>
</task>

<task type="checkpoint:human-action" gate="blocking">
  <action>Configure GitHub Pages source in repository settings</action>
  <instructions>
    I've created the deployment workflow file. Now you need to configure GitHub Pages:

    1. Go to: https://github.com/[YOUR_USERNAME]/website/settings/pages
    2. Under "Build and deployment", find "Source"
    3. Change from "Deploy from a branch" to "GitHub Actions"
    4. Click Save

    The workflow will run automatically on the next push to main.
  </instructions>
  <verification>
    After push, check: https://github.com/[YOUR_USERNAME]/website/actions
    Look for "Deploy to GitHub Pages" workflow run with green checkmark
  </verification>
  <resume-signal>Type "done" when GitHub Pages is configured to use GitHub Actions</resume-signal>
</task>

<task type="auto">
  <name>Task 2: Trigger deployment and verify</name>
  <files>No files modified - triggers workflow</files>
  <action>Commit and push the workflow file to trigger deployment:

```bash
git add .github/workflows/deploy.yml
git commit -m "feat(01-02): add GitHub Actions deployment workflow"
git push origin main
```

This push will trigger the workflow automatically. Wait for it to complete.
  </action>
  <verify>GitHub Actions workflow runs and completes (green checkmark in Actions tab)</verify>
  <done>Workflow completes successfully, deployment artifact created</done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>Deployed site on GitHub Pages</what-built>
  <how-to-verify>
    1. Check Actions tab: Workflow run should have green checkmark
    2. Click on workflow run > "Deploy to GitHub Pages" step
    3. Find deployment URL (usually https://[username].github.io/website/)
    4. Visit the URL
    5. Verify: Page loads (may show "404" if this is first deploy - wait 1-2 minutes)
    6. Verify: No browser console errors
    7. Check: Both / and /ta/ paths are accessible (even with same content for now)

    If 404 persists after 2 minutes: Check repo Settings > Pages > Source is "GitHub Actions"
  </how-to-verify>
  <resume-signal>Type "approved" when site is live, or describe issues</resume-signal>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] .github/workflows/deploy.yml exists and is valid YAML
- [ ] GitHub Pages source is set to "GitHub Actions" in repo settings
- [ ] Workflow runs successfully on push (green checkmark)
- [ ] Site is accessible at GitHub Pages URL
- [ ] Both / and /ta/ paths load without 404
</verification>

<success_criteria>

- GitHub Actions workflow file created
- GitHub Pages configured to use GitHub Actions as source
- Deployment completes successfully
- Site is live and accessible
- Future pushes to main will auto-deploy
  </success_criteria>

<output>
After completion, create `.planning/phases/01-foundation/01-02-SUMMARY.md`:

# Phase 1 Plan 2: GitHub Actions Deployment Summary

**GitHub Actions deployment workflow configured and site deployed successfully.**

## Accomplishments

- Created GitHub Actions workflow with official withastro/action@v5
- Configured GitHub Pages to use GitHub Actions as deployment source
- Site successfully deployed to https://[username].github.io/website/
- Continuous deployment enabled - every push to main auto-deploys

## Files Created/Modified

- `.github/workflows/deploy.yml` - Deployment workflow configuration

## Decisions Made

- Used official withastro/action@v5 (not custom build scripts) - per RESEARCH.md
- Set concurrency group to prevent overlapping deployments
- Required permissions: contents: read, pages: write, id-token: write

## Issues Encountered

None / [Document any issues if they occurred]

## Next Step

Ready for 01-03-PLAN.md (Layouts & Language Switcher)
</output>
